========================================
  Inferno SMART App Launch Test Runner  
========================================

Configuration:
  Inferno URL: http://localhost:4567
  FHIR Server: http://localhost:8445/proxy-smart-backend/hapi-fhir-server/R4
  Test Suite: smart_stu2_2
  Client ID: inferno-test-client

Checking Inferno availability...
✓ Inferno is ready
Launching browser for OAuth automation...
Creating test session for suite: smart_stu2_2
✓ Created test session: 5rwOC9MMvEd

=== Running SMART Discovery Tests ===

Auth info: {"auth_type":"public","use_discovery":"true","client_id":"inferno-test-client","requested_scopes":"launch/patient openid fhirUser offline_access patient/*.read","pkce_support":"enabled","pkce_code_challenge_method":"S256","auth_request_method":"GET"}
Available test groups:
  - smart_stu2_2-smart_full_standalone_launch: Standalone Launch
  - smart_stu2_2-smart_full_ehr_launch: EHR Launch
  - smart_stu2_2-smart_backend_services: Backend Services
  - smart_stu2_2-smart_token_introspection_stu2_2: Token Introspection

No discovery test group found, trying first group: smart_stu2_2-smart_full_standalone_launch
Starting test group: smart_stu2_2-smart_full_standalone_launch
✓ Started test run: e7fc0ac5-a4a0-436b-939b-85349740c0a1
Waiting for test run e7fc0ac5-a4a0-436b-939b-85349740c0a1 to complete (timeout: 3 minutes)...
  [Poll #1] Status: queued
  [Poll #2] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #3] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #4] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #5] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #6] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #7] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #8] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #9] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #10] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #11] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #12] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #13] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #14] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #15] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #16] Status: running
  Progress: 3 passed, 0 failed, 0 waiting, 3 total
  [Poll #17] Status: waiting
  Test is waiting for user action (OAuth flow)...
  Wait result keys: id, created_at, inputs, messages, optional, outputs, requests, result, result_message, test_id, test_run_id, test_session_id, updated_at
  result_message (first 500 chars): 
### Standalone Launch

[Follow this link to authorize with the SMART server](http://localhost:8445/auth/authorize?response_type=code&client_id=inferno-test-client&redirect_uri=http%3A%2F%2Flocalhost%3A4567%2Fcustom%2Fsmart_stu2_2%2Fredirect&scope=launch%2Fpatient+openid+fhirUser+offline_access+patient%2F*.read&state=6e2cdc75-d6cb-4b15-8ce7-8ae71d97d989&aud=http%3A%2F%2Flocalhost%3A8445%2Fproxy-smart-backend%2Fhapi-fhir-server%2FR4&code_challenge=Odho5qtVSyJN5nabrMuI60UTDcWLpBgGwrUpK_6beVg&code_
  messages (first 500 chars): [{"message":"Inferno redirecting browser to http://localhost:8445/auth/authorize?response_type=code&client_id=inferno-test-client&redirect_uri=http%3A%2F%2Flocalhost%3A4567%2Fcustom%2Fsmart_stu2_2%2Fredirect&scope=launch%2Fpatient+openid+fhirUser+offline_access+patient%2F*.read&state=6e2cdc75-d6cb-4b15-8ce7-8ae71d97d989&aud=http%3A%2F%2Flocalhost%3A8445%2Fproxy-smart-backend%2Fhapi-fhir-server%2FR4&code_challenge=Odho5qtVSyJN5nabrMuI60UTDcWLpBgGwrUpK_6beVg&code_challenge_method=S256.","type":"in
  Found OAuth URL in result_message: http://localhost:8445/auth/authorize?response_type=code&client_id=inferno-test-client&redirect_uri=http%3A%2F%2Flocalhost%3A4567%2Fcustom%2Fsmart_stu2_2%2Fredirect&scope=launch%2Fpatient+openid+fhirUser+offline_access+patient%2F*.read&state=6e2cdc75-d6cb-4b15-8ce7-8ae71d97d989&aud=http%3A%2F%2Flocalhost%3A8445%2Fproxy-smart-backend%2Fhapi-fhir-server%2FR4&code_challenge=Odho5qtVSyJN5nabrMuI60UTDcWLpBgGwrUpK_6beVg&code_challenge_method=S256
Handling OAuth flow...
  Navigating to: http://localhost:8445/auth/authorize?response_type=code&client_id=inferno-test-client&redirect_uri=http%3A%2F%2Flocalhost%3A4567%2Fcustom%2Fsmart_stu2_2%2Fredirect&scope=launch%2Fpatient+openid+fhirUser+offline_access+patient%2F*.read&state=6e2cdc75-d6cb-4b15-8ce7-8ae71d97d989&aud=http%3A%2F%2Flocalhost%3A8445%2Fproxy-smart-backend%2Fhapi-fhir-server%2FR4&code_challenge=Odho5qtVSyJN5nabrMuI60UTDcWLpBgGwrUpK_6beVg&code_challenge_method=S256
  Navigation response status: 200
  Current URL after navigation: http://localhost:8080/realms/proxy-smart/protocol/openid-connect/auth?response_type=code&client_id=inferno-test-client&redirect_uri=http%3A%2F%2Flocalhost%3A4567%2Fcustom%2Fsmart_stu2_2%2Fredirect&scope=launch%2Fpatient+openid+fhirUser+offline_access+patient%2F*.read&state=6e2cdc75-d6cb-4b15-8ce7-8ae71d97d989&code_challenge=Odho5qtVSyJN5nabrMuI60UTDcWLpBgGwrUpK_6beVg&code_challenge_method=S256
  On Keycloak login page, entering credentials...
  Filled username
  Filled password
  Clicked login button
  ✓ OAuth flow completed, redirected back to Inferno
  OAuth flow completed, continuing to poll...
  Progress: 5 passed, 1 failed, 3 waiting, 9 total
  [Poll #18] Status: done
Test completed with status: done

========================================
          TEST RESULTS SUMMARY          
========================================

✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_discovery_stu2_2-well_known_endpoint
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_discovery_stu2_2-well_known_capabilities_stu2
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_discovery_stu2_2-smart_cors_well_known_endpoint
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_discovery_stu2_2-smart_cors_metadata_request
✗ FAIL: smart_stu2_2-smart_full_standalone_launch-smart_standalone_launch_stu2_2-standalone_auth_tls
    http://localhost:8445/auth/authorize correctly denied SSL 2.0 connection as required.
    http://localhost:8445/auth/authorize correctly denied SSL 3.0 connection as required.
    http://localhost:8445/auth/authorize correctly denied TLS 1.0 connection as required.
    http://localhost:8445/auth/authorize correctly denied TLS 1.1 connection as required.
    http://localhost:8445/auth/authorize denied TLS 1.2 connection.
    http://localhost:8445/auth/authorize denied TLS 1.3 connection.
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_launch_stu2_2-smart_app_redirect_stu2
✓ PASS: Unknown test
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_launch_stu2_2-smart_code_received
✗ FAIL: smart_stu2_2-smart_full_standalone_launch-smart_standalone_launch_stu2_2-standalone_token_tls
    http://localhost:8445/auth/token correctly denied SSL 2.0 connection as required.
    http://localhost:8445/auth/token correctly denied SSL 3.0 connection as required.
    http://localhost:8445/auth/token correctly denied TLS 1.0 connection as required.
    http://localhost:8445/auth/token correctly denied TLS 1.1 connection as required.
    http://localhost:8445/auth/token denied TLS 1.2 connection.
    http://localhost:8445/auth/token denied TLS 1.3 connection.
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_launch_stu2_2-smart_token_exchange_stu2_2
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_launch_stu2_2-smart_token_response_body_stu2_2
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_launch_stu2_2-smart_token_response_headers
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_launch_stu2_2-smart_cors_token_exchange
✗ FAIL: Unknown test
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_openid_connect_stu2_2-smart_openid_decode_id_token
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_openid_connect_stu2_2-smart_openid_retrieve_configuration
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_openid_connect_stu2_2-smart_openid_required_configuration_fields
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_openid_connect_stu2_2-smart_openid_retrieve_jwks
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_openid_connect_stu2_2-smart_openid_token_header
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_openid_connect_stu2_2-smart_openid_token_payload
✗ FAIL: smart_stu2_2-smart_full_standalone_launch-smart_openid_connect_stu2_2-smart_openid_fhir_user_claim
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_openid_connect_stu2_2-smart_cors_openid_fhir_user_claim
✗ FAIL: Unknown test
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_refresh_without_scopes-smart_token_refresh_stu2
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_refresh_without_scopes-smart_token_refresh_body
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_refresh_without_scopes-smart_token_response_headers
✓ PASS: Unknown test
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_refresh_with_scopes-smart_token_refresh_stu2
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_refresh_with_scopes-smart_token_refresh_body
✓ PASS: smart_stu2_2-smart_full_standalone_launch-smart_standalone_refresh_with_scopes-smart_token_response_headers
✓ PASS: Unknown test
✗ FAIL: Unknown test

========================================
Total: 32 | Passed: 26 | Failed: 6 | Skipped: 0 | Errors: 0
========================================


❌ Tests failed: 6 failed, 0 errors
